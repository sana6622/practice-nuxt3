<script setup>
import { useRoute, useRouter } from "vue-router";
// import { useAuthStore } from "@/store/auth";

const route = useRoute();
const router = useRouter();
const auth = useAuthStore();

// å–å¾—ç™»å…¥è³‡è¨Š
const userInfo = {
  id: route.query.id,
  email: route.query.email,
  name: route.query.name,
  picture: route.query.picture,
  token: route.query.token,
};

if (userInfo.token) {
  console.log("âœ… Google ç™»å…¥æˆåŠŸï¼Œç²å–ä½¿ç”¨è€…è³‡è¨Š:", userInfo);

  // âœ… å„²å­˜åˆ° Pinia
  auth.setUser(
    {
      id: userInfo.id,
      email: userInfo.email,
      name: userInfo.name,
      picture: userInfo.picture,
    },
    userInfo.token
  );

  // âœ… ç§»é™¤ URL ä¸Šçš„ `token`ï¼Œé¿å…æš´éœ² Token
  setTimeout(() => {
    // router.replace("/");
  }, 2000);
}
</script>

<template>
  <div class="success-container">
    <p>{{ auth.user }}</p>
    <h2>ğŸ‰ ç™»å…¥æˆåŠŸï¼æ­£åœ¨è·³è½‰...</h2>
  </div>
</template>

<style scoped>
.success-container {
  text-align: center;
  margin-top: 50px;
}
</style>
